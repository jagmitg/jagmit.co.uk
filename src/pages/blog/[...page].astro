---
import type { GetStaticPathsOptions, Page } from "astro";
import type { CollectionEntry } from "astro:content";
import Pagination from "../../components/Pagination.astro";
import TagsBox from "../../components/TagsBox.astro";
import { BLOG_DESCRIPTION } from "../../constants";
import Layout from "../../layouts/Layout.astro";
import MainLayout from "../../layouts/MainLayout.astro";
import { getAllTags, getBlogs } from "../../utils/blog";
import BlogCardItem from "../../components/BlogCardItem.astro";

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
  return paginate(await getBlogs(), { pageSize: 20 });
}

const allTags = getAllTags(await getBlogs());
const { page } = Astro.props as {
  page: Page<CollectionEntry<"blog">>;
};
---

<Layout description={BLOG_DESCRIPTION}>
  <MainLayout>
    <div class="flex justify-between items-center py-6">
      <h2 class="text-2xl">Read my blog...</h2>
      <TagsBox tags={allTags} slot="optional-content" />
    </div>

    {
      page.data.map(({ data, slug }) => (
        <>
          <BlogCardItem url={slug} frontmatter={data} />
        </>
      ))
    }
    <Pagination prev={page.url.prev} next={page.url.next} />
  </MainLayout>
</Layout>
<style is:global>
  a.blogItemLink {
    border: 1px solid #fff;
    display: block;
    cursor: pointer;
    transition-property: all;
    transition-timing-function: fade;
    transition-duration: 150ms;
  }
  a.blogItemLink:hover {
    border: 1px solid #b9e1ff;
  }
</style>
